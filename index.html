<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã‚²ãƒ¬ãƒ³ãƒ‡ãƒ©ã‚¤ãƒ– Ã— æ°—è±¡åº</title>
<style>
body {
  font-family: sans-serif;
  background: #eef6fb;
  padding: 15px;
}
h1 { text-align: center; }
select {
  width: 100%;
  padding: 10px;
  font-size: 16px;
}
iframe {
  width: 100%;
  height: 240px;
  border: none;
  margin-top: 10px;
}
.hidden { display: none; }
.weather {
  background: white;
  padding: 12px;
  border-radius: 8px;
  margin: 10px 0;
}
.btn {
  display: block;
  text-align: center;
  padding: 10px;
  background: #0077cc;
  color: white;
  text-decoration: none;
  border-radius: 6px;
  font-weight: bold;
}
.note {
  font-size: 12px;
  text-align: center;
  color: #555;
}
</style>
</head>
<body>

<h1>ğŸ¿ å…¨å›½ ã‚²ãƒ¬ãƒ³ãƒ‡ãƒ©ã‚¤ãƒ–</h1>

<select id="spot" onchange="update()">
  <option value="">ã‚²ãƒ¬ãƒ³ãƒ‡ã‚’é¸æŠ</option>
  <option value="sapporo">æœ­å¹Œå›½éš›ã‚¹ã‚­ãƒ¼å ´</option>
  <option value="naeba">è‹—å ´ã‚¹ã‚­ãƒ¼å ´</option>
  <option value="hakuba">ç™½é¦¬å…«æ–¹å°¾æ ¹</option>
  <option value="shiga">å¿—è³€é«˜åŸ</option>
  <option value="zao">è”µç‹æ¸©æ³‰ã‚¹ã‚­ãƒ¼å ´</option>
</select>

<iframe
  id="live"
  allow="accelerometer; autoplay; encrypted-media; picture-in-picture"
  allowfullscreen>
</iframe>

<a id="youtubeBtn" class="btn hidden" target="_blank">
â–¶ YouTubeã§è¦‹ã‚‹
</a>

<div class="weather" id="weather">
å¤©æ°—æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™
</div>

<a id="jmaLink" class="btn" target="_blank">
ğŸŒ¤ æ°—è±¡åºã®è©³ç´°ã‚’è¦‹ã‚‹
</a>

<p class="note">
â€»å‹•ç”»ãŒå†ç”Ÿã§ããªã„å ´åˆã¯è‡ªå‹•ã§YouTubeã«åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™
</p>

<script>
const spots = {
  sapporo: {
    embed: "https://www.youtube.com/embed/t6xH1gWQF6k",
    watch: "https://www.youtube.com/watch?v=t6xH1gWQF6k",
    code: "016000",
    jma: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=016000"
  },
  naeba: {
    embed: "https://www.youtube.com/embed/ZpZK8K2pD9M",
    watch: "https://www.youtube.com/watch?v=ZpZK8K2pD9M",
    code: "150000",
    jma: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=150000"
  },
  hakuba: {
    embed: "https://www.youtube.com/embed/0W7XGfXK0xA",
    watch: "https://www.youtube.com/watch?v=0W7XGfXK0xA",
    code: "200000",
    jma: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=200000"
  },
  shiga: {
    embed: "https://www.youtube.com/embed/3m7uFhYdC3M",
    watch: "https://www.youtube.com/watch?v=3m7uFhYdC3M",
    code: "200000",
    jma: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=200000"
  },
  zao: {
    embed: "https://www.youtube.com/embed/VK6Pz8LZr5M",
    watch: "https://www.youtube.com/watch?v=VK6Pz8LZr5M",
    code: "060000",
    jma: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=060000"
  }
};

let timer;

function update() {
  clearTimeout(timer);
  const key = document.getElementById("spot").value;
  if (!key) return;

  const s = spots[key];
  const iframe = document.getElementById("live");
  const yt = document.getElementById("youtubeBtn");

  iframe.src = s.embed;
  iframe.classList.remove("hidden");

  yt.href = s.watch;
  yt.classList.add("hidden");

  document.getElementById("jmaLink").href = s.jma;

  // 5ç§’å¾Œã«å†ç”Ÿã§ããªã‘ã‚Œã°YouTubeã¸
  timer = setTimeout(() => {
    iframe.classList.add("hidden");
    yt.classList.remove("hidden");
  }, 5000);

  fetch(`https://www.jma.go.jp/bosai/forecast/data/forecast/${s.code}.json`)
    .then(r => r.json())
    .then(data => {
      const a = data[0].timeSeries[0].areas[0];
      document.getElementById("weather").innerHTML = `
        <strong>${a.area.name}</strong><br>
        ä»Šæ—¥ï¼š${a.weathers[0]}<br>
        æ˜æ—¥ï¼š${a.weathers[1]}
      `;
    });
}
</script>

</body>
</html>
