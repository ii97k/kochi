<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>æµ·ãƒ©ã‚¤ãƒ– Ã— æ°—è±¡åº</title>
<style>
body {
  font-family: sans-serif;
  background: #eef6fb;
  padding: 15px;
}
h1 { text-align: center; }
select {
  width: 100%;
  padding: 10px;
  font-size: 16px;
  margin-bottom: 10px;
}
iframe {
  width: 100%;
  height: 240px;
  border: none;
}
.hidden { display: none; }
.weather {
  background: #fff;
  padding: 12px;
  border-radius: 8px;
  margin: 10px 0;
}
.btn {
  display: block;
  text-align: center;
  padding: 10px;
  background: #0077cc;
  color: white;
  text-decoration: none;
  border-radius: 6px;
  margin-top: 10px;
  font-weight: bold;
}
.warn {
  text-align: center;
  font-size: 13px;
  color: #555;
}
</style>
</head>
<body>

<h1>ğŸŒŠ æµ·ã®ãƒ©ã‚¤ãƒ–ã‚«ãƒ¡ãƒ©</h1>

<select id="spot" onchange="update()">
  <option value="">æµ·ã‚’é¸æŠ</option>
  <option value="shirarahama">ç™½è‰¯æµœï¼ˆå’Œæ­Œå±±ï¼‰</option>
  <option value="aoshima">é’å³¶æµ·å²¸ï¼ˆå®®å´ï¼‰</option>
  <option value="tottori">é³¥å–ç ‚ä¸˜</option>
</select>

<iframe
  id="live"
  allow="accelerometer; autoplay; encrypted-media; picture-in-picture"
  allowfullscreen>
</iframe>

<a id="youtubeBtn" class="btn hidden" target="_blank">
â–¶ YouTubeã§è¦‹ã‚‹
</a>

<div class="weather" id="weather">
å¤©æ°—æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™
</div>

<a id="jmaLink" class="btn" target="_blank">
ğŸŒ¤ æ°—è±¡åºã®è©³ç´°ã‚’è¦‹ã‚‹
</a>

<p class="warn">
â€»å‹•ç”»ãŒå†ç”Ÿã§ããªã„å ´åˆã¯è‡ªå‹•ã§YouTubeã«åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™
</p>

<script>
const spots = {
  shirarahama: {
    embed: "https://www.youtube.com/embed/drTCMJhgpSI",
    watch: "https://www.youtube.com/watch?v=drTCMJhgpSI",
    code: "300000",
    jma: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=300000"
  },
  aoshima: {
    embed: "https://www.youtube.com/embed/6zQ1ZzqzF3I",
    watch: "https://www.youtube.com/watch?v=6zQ1ZzqzF3I",
    code: "450000",
    jma: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=450000"
  },
  tottori: {
    embed: "https://www.youtube.com/embed/V0xZKZpGQ2M",
    watch: "https://www.youtube.com/watch?v=V0xZKZpGQ2M",
    code: "310000",
    jma: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=310000"
  }
};

let timer;

function update() {
  clearTimeout(timer);

  const key = document.getElementById("spot").value;
  if (!key) return;

  const s = spots[key];
  const iframe = document.getElementById("live");
  const ytBtn = document.getElementById("youtubeBtn");

  iframe.src = s.embed;
  iframe.classList.remove("hidden");

  ytBtn.href = s.watch;
  ytBtn.classList.add("hidden");

  document.getElementById("jmaLink").href = s.jma;

  // 5ç§’å¾Œã«å†ç”Ÿã§ããªã‘ã‚Œã°YouTubeã«åˆ‡ã‚Šæ›¿ãˆ
  timer = setTimeout(() => {
    iframe.classList.add("hidden");
    ytBtn.classList.remove("hidden");
  }, 5000);

  fetch(`https://www.jma.go.jp/bosai/forecast/data/forecast/${s.code}.json`)
    .then(r => r.json())
    .then(data => {
      const a = data[0].timeSeries[0].areas[0];
      document.getElementById("weather").innerHTML = `
        <strong>${a.area.name}</strong><br>
        ä»Šæ—¥ï¼š${a.weathers[0]}<br>
        æ˜æ—¥ï¼š${a.weathers[1]}
      `;
    });
}
</script>

</body>
</html>
